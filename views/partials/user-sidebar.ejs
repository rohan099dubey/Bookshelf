<!-- User Sidebar -->
<div
  id="user-sidebar-backdrop"
  class="fixed inset-0 bg-black bg-opacity-50 z-[90] hidden transition-opacity duration-300 ease-in-out"
  aria-hidden="true"
></div>
<aside
  id="user-sidebar"
  class="fixed top-0 right-0 h-full w-72 md:w-80 bg-neutral-100 shadow-xl z-[100] transform translate-x-full transition-transform duration-300 ease-in-out fade-in"
  role="dialog"
  aria-modal="true"
  aria-labelledby="sidebar-title"
>
  <div class="flex flex-col h-full">
    <!-- Sidebar Header -->
    <div
      class="flex items-center justify-between p-4 border-b border-neutral-300"
    >
      <h2 id="sidebar-title" class="text-lg font-semibold text-neutral-800">
        <% if (user) { %> <%= user.name %> <% } else { %> Menu <% } %>
      </h2>
      <button
        id="close-sidebar-button"
        class="text-neutral-600 hover:text-coral-600 transition-colors"
        aria-label="Close menu"
      >
        <i class="fas fa-times text-xl"></i>
      </button>
    </div>

    <!-- User Info (Optional) -->
    <% if (user && user.avatar) { %>
    <div class="p-4 flex items-center space-x-3 border-b border-neutral-300">
      <img
        src="<%= user.avatar %>"
        alt="<%= user.name %>"
        class="h-12 w-12 rounded-full object-cover"
      />
      <div>
        <p class="text-sm font-medium text-neutral-800 truncate">
          <%= user.name %>
        </p>
        <p class="text-xs text-neutral-600 truncate"><%= user.email %></p>
      </div>
    </div>
    <% } %>

    <!-- Navigation Links -->
    <nav class="flex-grow p-4 space-y-2 overflow-y-auto">
      <!-- New Community Features Section -->
      <div class="mb-3">
        <p class="text-sm font-medium uppercase text-neutral-500 mb-2">
          Community Features
        </p>
        <div class="space-y-1">
          <a href="/blog" class="sidebar-link group">
            <i
              class="fas fa-blog mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
            ></i
            >Reader Blogs
          </a>
          <a href="/recommendations" class="sidebar-link group">
            <i
              class="fas fa-list-alt mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
            ></i
            >Book Recommendations
          </a>
          <a href="/groups" class="sidebar-link group">
            <i
              class="fas fa-users mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
            ></i
            >Genre Communities
          </a>
          <a href="/ebooks" class="sidebar-link group">
            <i
              class="fas fa-tablet-alt mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
            ></i
            >E-Book Marketplace
          </a>
          <a href="/universities" class="sidebar-link group">
            <i
              class="fas fa-university mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
            ></i
            >University Groups
          </a>
        </div>
      </div>

      <div class="border-t border-neutral-300 my-2"></div>

      <% if (user) { %>
      <p class="text-sm font-medium uppercase text-neutral-500 mb-2">
        My Account
      </p>
      <% if (user.role === 'buyer') { %>
      <a href="/buyer/profile" class="sidebar-link group">
        <i
          class="fas fa-user-edit mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >My Profile
      </a>
      <a href="/buyer/orders" class="sidebar-link group">
        <i
          class="fas fa-receipt mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >My Orders
      </a>
      <a href="/buyer/library" class="sidebar-link group">
        <i
          class="fas fa-book-bookmark mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >My Library
      </a>
      <a href="/buyer/profile/addresses" class="sidebar-link group">
        <i
          class="fas fa-map-marked-alt mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >My Addresses
      </a>
      <a href="/buyer/register-complaint" class="sidebar-link group">
        <i
          class="fas fa-exclamation-triangle mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Register Complaint
      </a>
      <% } else if (user.role === 'seller') { %>
      <a href="/seller/dashboard" class="sidebar-link group">
        <i
          class="fas fa-tachometer-alt mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Dashboard
      </a>
      <a href="/seller/inventory" class="sidebar-link group">
        <i
          class="fas fa-boxes mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Inventory
      </a>
      <a href="/seller/upload" class="sidebar-link group">
        <i
          class="fas fa-upload mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Upload Book
      </a>
      <a href="/seller/orders" class="sidebar-link group">
        <i
          class="fas fa-shipping-fast mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Orders
      </a>
      <a href="/seller/register-complaint" class="sidebar-link group">
        <i
          class="fas fa-exclamation-triangle mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Register Complaint
      </a>
      <% } else if (user.role === 'admin') { %>
      <a href="/admin/users" class="sidebar-link group">
        <i
          class="fas fa-users-cog mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >User Management
      </a>
      <a href="/admin/content" class="sidebar-link group">
        <i
          class="fas fa-shield-alt mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Content Moderation
      </a>
      <a href="/admin/orders" class="sidebar-link group">
        <i
          class="fas fa-cogs mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Order Management
      </a>
      <a href="/admin/reports" class="sidebar-link group">
        <i
          class="fas fa-chart-line mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >System Reports
      </a>
      <a href="/admin/complaints" class="sidebar-link group">
        <i
          class="fas fa-gavel mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >View Complaints
      </a>
      <% } %>
      <div class="border-t border-neutral-300 pt-2 mt-2"></div>
      <a
        href="/auth/logout"
        class="sidebar-link group text-coral-700 hover:text-coral-800"
      >
        <i
          class="fas fa-sign-out-alt mr-3 text-coral-700 group-hover:text-coral-800 transition-colors"
        ></i
        >Logout
      </a>
      <% } else { %>
      <p class="text-neutral-600 text-sm">Please log in to see more options.</p>
      <a href="/auth/login" class="sidebar-link group">
        <i
          class="fas fa-sign-in-alt mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Login
      </a>
      <a href="/auth/register" class="sidebar-link group">
        <i
          class="fas fa-user-plus mr-3 text-neutral-500 group-hover:text-coral-600 transition-colors"
        ></i
        >Register
      </a>
      <% } %>
    </nav>
  </div>
</aside>
